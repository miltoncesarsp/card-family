<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Admin - Gerenciador Unificado</title>
    <link rel="stylesheet" href="style.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

    <header class="admin-header">
        <h2>üëë Painel Admin</h2>
        <div class="admin-tabs-nav">
            <button class="tab-btn active" onclick="openTab('tab-base')">
                <i class="fas fa-dna"></i> <span class="tab-text">Bases</span>
            </button>
            <button class="tab-btn" onclick="openTab('tab-cards')">
                <i class="fas fa-id-card"></i> <span class="tab-text">Cartas</span>
            </button>
            <button class="tab-btn" onclick="openTab('tab-origins')">
                <i class="fas fa-book"></i> <span class="tab-text">Origens</span>
            </button>
            <button class="tab-btn" onclick="openTab('tab-packs')">
                <i class="fas fa-box-open"></i> <span class="tab-text">Pacotes</span>
            </button>
            <button class="tab-btn" onclick="openTab('tab-players')">
                <i class="fas fa-users"></i> <span class="tab-text">Jogadores</span>
            </button>
            <button class="tab-btn" onclick="openTab('tab-rules')">
                <i class="fas fa-balance-scale"></i> <span class="tab-text">Regras</span>
            </button>
        </div>
    </header>

    <div class="main-forms-container">

        <div id="tab-base" class="tab-content active">
            <div class="form-section full-width">
                <h3>‚ú® Criar/Editar Personagem Base</h3>
                <form class="card-form base-form" id="baseForm">
                    <label>Nome do Personagem (Ex: Hulk):</label>
                    <input id="basePersonagem" type="text" required>
                    
                    <label>Origem (Ex: Marvel):</label>
                    <input id="baseOrigem" type="text" required>
                    
                    <label>Elemento Padr√£o:</label>
                    <select id="baseElemento" required>
                        <option value="Terra">Terra</option>
                        <option value="Fogo">Fogo</option>
                        <option value="√Ågua">√Ågua</option>
                        <option value="Ar">Ar</option>
                        <option value="Tecnologia">Tecnologia</option>
                        <option value="Luz">Luz</option>
                        <option value="Sombra">Sombra</option>
                    </select>
                    
                    <button type="button" id="saveBaseBtn">Salvar Personagem Base</button>
                </form>
            </div>
            </div>

        <div id="tab-cards" class="tab-content">
            <div class="admin-search-container">
                <input type="text" id="adminSearchInput" class="admin-search-input" placeholder="üîç Buscar personagem na lista...">
            </div>

            <div class="form-section full-width">
                <h3>üÉè Criar Nova Carta</h3>
                <form class="card-form" id="cardForm">
                    <label>Nome do Personagem:</label>
                    <input id="cardName" type="text" list="personagem-nomes">
                    <datalist id="personagem-nomes"></datalist>

                    <div style="display:flex; gap:10px;">
                        <div style="flex:1;">
                            <label>For√ßa:</label>
                            <input id="cardPower" type="number" min="0">
                        </div>
                        <div style="flex:1;">
                            <label>Raridade:</label>
                            <select id="cardRarity">
                                <option value="Comum">Comum</option>
                                <option value="Rara">Rara</option>
                                <option value="√âpica">√âpica</option>
                                <option value="Lend√°ria">Lend√°ria</option>
                                <option value="M√≠tica">M√≠tica</option>
                            </select>
                        </div>
                    </div>
                    
                    <label>Imagem da carta:</label>
                    <input id="fileInput" type="file" accept="image/*">
                    
                    <button type="button" id="saveCardBtn">Salvar Carta</button>
                    <div id="cardPreviewContainer" style="margin-top:20px; display:flex; justify-content:center;"></div>
                </form>
            </div>

            <hr>
            <h3>üìä Linha de Evolu√ß√£o (Gerenciar Cartas)</h3>
            <div id="unifiedListContainer"></div>
        </div>

        <div id="tab-origins" class="tab-content">
            <div class="form-section full-width">
                <h3>üñºÔ∏è Capas das Origens (√Ålbum)</h3>
                <form class="card-form" id="originCoverForm">
                    <label>Nome da Origem (Ex: Marvel):</label>
                    <input id="originNameInput" type="text" placeholder="Igual ao cadastro da base" required>
                    <label>Imagem da Capa:</label>
                    <input id="originFileInput" type="file" accept="image/*" required>
                    <button type="button" id="saveOriginCoverBtn">Salvar Capa</button>
                </form>
                <hr>
                <h4>Capas Cadastradas</h4>
                <div id="originCoversList" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top:20px;"></div>
            </div>
        </div>

        <div id="tab-packs" class="tab-content">
            <button type="button" id="newPackBtn" style="margin-bottom: 15px;">+ Novo Pacote</button>
            <div class="form-wrapper" id="packFormContainer" style="display:none; margin-bottom:20px;">
                <h3>üì¶ Criar/Editar Pacote</h3>
                <form class="card-form" id="packForm">
                    <input type="hidden" id="packIdInput"> 
                    <label>Nome:</label><input id="packNameInput" type="text">
                    <label>Pre√ßo:</label><input id="packPriceInput" type="number">
                    <label>Total Cartas:</label><input id="packTotalCardsInput" type="number">
                    
                    <h4>Chances (%)</h4>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                        <div><label>Comum:</label><input id="chanceComumInput" type="number"></div>
                        <div><label>Rara:</label><input id="chanceRaraInput" type="number"></div>
                        <div><label>√âpica:</label><input id="chanceEpicaInput" type="number"></div>
                        <div><label>Lend√°ria:</label><input id="chanceLendariaInput" type="number"></div>
                        <div><label>M√≠tica:</label><input id="chanceMiticaInput" type="number"></div>
                    </div>
                    
                    <label>Imagem Capa:</label>
                    <input id="packFileInput" type="file" accept="image/*">
                    <input type="hidden" id="packCurrentImageUrl">
                    <button type="button" id="savePackBtn">Salvar Pacote</button>
                </form>
            </div>
            <div id="packsContainer"></div>
        </div>

        <div id="tab-players" class="tab-content">
            <h3>üë§ Gerenciar Jogadores</h3>
            <p style="font-size:0.8em; color:#aaa;">Cuidado ao editar saldos.</p>
            <div id="playersContainer"></div>
            
            <div class="form-wrapper" id="playerEditFormSection" style="display:none; margin-top: 20px; border: 2px solid #FFD700; padding:15px; border-radius:10px;">
                <h4>Editar Jogador</h4>
                <input type="hidden" id="playerEditId"> 
                <label>Email:</label><input id="playerEditEmail" disabled>
                <label>Nome:</label><input id="playerEditName"> 
                <label>Moedas:</label><input id="playerEditMoedas" type="number">
                <label>N√≠vel:</label><input id="playerEditNivel" type="number">
                <button type="button" id="savePlayerEditBtn">Atualizar</button>
            </div>
        </div>

        <div id="tab-rules" class="tab-content">
            <h3>üìú Regras de Evolu√ß√£o</h3>
            <div id="rarityRulesContainer"></div>
            <div class="form-wrapper" id="rarityRulesFormSection" style="display:none; margin-top:20px;">
                <h4>Editar Regra</h4>
                <form class="card-form">
                    <label>Raridade:</label><input id="rarityNameInput" disabled>
                    <label>Custo Evolu√ß√£o:</label><input id="evolutionCostInput" type="number">
                    <label>Ordem:</label><input id="orderInput" type="number">
                    <button type="button" id="saveRarityBtn">Salvar</button>
                </form>
            </div>
        </div>

    </div>

    <div id="editBaseModal" class="modal-overlay hidden">
    <div class="admin-modal-content">
        <div class="admin-modal-header">
            <h3>üß¨ Editar Base</h3>
            <button class="close-admin-modal" onclick="closeModal('editBaseModal')">&times;</button>
        </div>
        <form class="modern-form">
            <input type="hidden" id="modalBaseId">
            
            <label>Nome do Personagem:</label>
            <input id="modalBasePersonagem" type="text">
            
            <label>Origem:</label>
            <input id="modalBaseOrigem" type="text">
            
            <label>Elemento Padr√£o:</label>
            <select id="modalBaseElemento">
                <option value="Terra">Terra</option>
                <option value="Fogo">Fogo</option>
                <option value="√Ågua">√Ågua</option>
                <option value="Ar">Ar</option>
                <option value="Tecnologia">Tecnologia</option>
                <option value="Luz">Luz</option>
                <option value="Sombra">Sombra</option>
            </select>
            
            <button type="button" id="modalSaveBaseBtn" class="btn-save">Atualizar Base</button>
        </form>
    </div>
</div>

<div id="editPackModal" class="modal-overlay hidden">
    <div class="admin-modal-content">
        <div class="admin-modal-header">
            <h3>üì¶ Editar Pacote</h3>
            <button class="close-admin-modal" onclick="closeModal('editPackModal')">&times;</button>
        </div>
        <form class="modern-form">
            <input type="hidden" id="modalPackId">
            
            <div class="form-row">
                <div><label>Nome:</label><input id="modalPackName" type="text"></div>
                <div><label>Pre√ßo:</label><input id="modalPackPrice" type="number"></div>
            </div>
            
            <label>Total de Cartas:</label>
            <input id="modalPackTotal" type="number">
            
            <label style="color:var(--coin-color); margin-top:10px;">Chances de Drop (%):</label>
            <div class="form-row">
                <div><label>Comum:</label><input id="modalChanceComum" type="number"></div>
                <div><label>Rara:</label><input id="modalChanceRara" type="number"></div>
                <div><label>√âpica:</label><input id="modalChanceEpica" type="number"></div>
            </div>
            <div class="form-row">
                <div><label>Lend√°ria:</label><input id="modalChanceLendaria" type="number"></div>
                <div><label>M√≠tica:</label><input id="modalChanceMitica" type="number"></div>
            </div>

            <label>Alterar Capa (Opcional):</label>
            <input id="modalPackFile" type="file" accept="image/*">
            <input type="hidden" id="modalPackCurrentUrl">

            <button type="button" id="modalSavePackBtn" class="btn-save">Atualizar Pacote</button>
        </form>
    </div>
</div>

<div id="editPlayerModal" class="modal-overlay hidden">
    <div class="admin-modal-content">
        <div class="admin-modal-header">
            <h3>üë§ Editar Jogador</h3>
            <button class="close-admin-modal" onclick="closeModal('editPlayerModal')">&times;</button>
        </div>
        <form class="modern-form">
            <input type="hidden" id="modalPlayerId">
            
            <label>Email (Somente Leitura):</label>
            <input id="modalPlayerEmail" type="text" disabled>
            
            <label>Nome:</label>
            <input id="modalPlayerName" type="text">
            
            <div class="form-row">
                <div><label>Moedas:</label><input id="modalPlayerMoedas" type="number"></div>
                <div><label>N√≠vel:</label><input id="modalPlayerNivel" type="number"></div>
            </div>
            
            <button type="button" id="modalSavePlayerBtn" class="btn-save">Salvar Jogador</button>
        </form>
    </div>
</div>

<div id="editRuleModal" class="modal-overlay hidden">
    <div class="admin-modal-content">
        <div class="admin-modal-header">
            <h3>‚öñÔ∏è Regra de Evolu√ß√£o</h3>
            <button class="close-admin-modal" onclick="closeModal('editRuleModal')">&times;</button>
        </div>
        <form class="modern-form">
            <label>Raridade:</label>
            <input id="modalRuleName" type="text" disabled>
            
            <label>Cartas Repetidas para Evoluir:</label>
            <input id="modalRuleCost" type="number">
            
            <label>Ordem de For√ßa:</label>
            <input id="modalRuleOrder" type="number">
            
            <button type="button" id="modalSaveRuleBtn" class="btn-save">Atualizar Regra</button>
        </form>
    </div>
</div>

    
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script src="supabaseClient-v2.js?v=2"></script>
    <script src="admin.js?v=3"></script> 
</body>
</html>

<div id="editCardModal" class="modal-overlay hidden">
    <div class="admin-modal-content">
        <div class="admin-modal-header">
            <h3>‚úèÔ∏è Editar Carta</h3>
            <button type="button" class="close-admin-modal" onclick="closeEditModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form class="card-form" id="modalCardForm" style="box-shadow: none; padding: 0; margin: 0;">
            <input type="hidden" id="modalCardId">
            <input type="hidden" id="modalBaseId"> <label>Nome (Visualiza√ß√£o):</label>
            <input id="modalCardName" type="text" disabled style="background: #eee;">

            <label>For√ßa:</label>
            <input id="modalCardPower" type="number" min="0">
            
            <label>Raridade:</label>
            <select id="modalCardRarity">
                <option value="Comum">Comum</option>
                <option value="Rara">Rara</option>
                <option value="√âpica">√âpica</option>
                <option value="Lend√°ria">Lend√°ria</option>
                <option value="M√≠tica">M√≠tica</option>
            </select>
            
            <label>Atualizar Imagem (Opcional):</label>
            <input id="modalFileInput" type="file" accept="image/*">
            <div id="modalImagePreview" style="margin-top: 10px; height: 100px; background-size: contain; background-repeat: no-repeat;"></div>

            <button type="button" id="modalSaveBtn" class="btn-primary" style="margin-top: 20px;">üíæ Salvar Altera√ß√µes</button>
        </form>
    </div>
</div>

<div id="toastContainer" class="toast-container"></div>
